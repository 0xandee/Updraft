## Chainlink CCIP

We are going to send a cross chain message from Sepolia to Arbitrum. So to do this we can go to the CCIP documentation, head down to guides, and then all the way down to send arbitrary data, which will walk us through step by step what is happening. I'm going to rattle through this as quickly as we can so that we can get a feel for how to send a message cross chain and how it works.

So the first thing we need to do is open up our contract in Remix. So if we go to the messenger file then we head to the compiler. Let's make sure the compiler version is the same then we can compile the contract then we can hit to the deploy and run transactions tab. Make sure that we have selected inject provider, MetaMask, and that we are on Sepolia. Now we need to deploy our smart contract. Fill in the constructor parameters which require you to have the router address and the LINK token address, and the way we can get those addresses is from the CCIP directory. So if we scroll down, and here you'll find the router address and the LINK token address, which we can click to copy, paste the router address in, copy the LINK address, paste that address in, click transact to deploy the smart contract. 

Then, once that's done we'll see this deployed contracts tab. First we need to pin the contract for the current workspace and network to persist after reloading so that when we switch chains then this contract will persist. Now we need to call allow list destination chain to allow us to send messages to Arbitrum Sepolia. And we need to paste in the destination chain selector for Arbitrum Sepolia, and then in here for the boolean whether it's allowed, will be true. So if we go back to the supported networks, then we can click on Arbitrum Sepolia, and copy this destination chain selector which we can paste in here, then hit transact, confirm the transaction in MetaMask. It's going through. The final thing we would need to do is call send message pay LINK or send message pay native, and in order to do that we either need to send native tokens to this contract or LINK tokens to this contract, but the first thing we're going to do actually is going to be to deploy our smart contract also to Arbitrum Sepolia. Select one of the other options, like the Remix RM, then we change the network to be Arbitrum Sepolia, then we hit MetaMask to make sure that we are connected to Arbitrum Sepolia. Then we need to go back to our supported networks. We need to find Arbitrum Sepolia, copy the router address, paste that into the constructor parameters, and then same with the LINK token and we can hit transact to deploy the smart contract on Arbitrum. Then once that has been deployed we need to make sure that we pin the contract. Copy the address. Then we need to scroll down into the transactions, and call allow list source chain. 

We then need to get the Sepolia destination chain selector. Paste that in, and then set this boolean to true to allow us to be able to receive messages from Sepolia. Hit confirm, and now that we've done that the final thing we need to do is add allow list sender, which is going to be the address of the contract deployed on Sepolia, and then add true for the boolean. So make sure that we have the contract pinned, and then we can switch over to Sepolia. Get the contract address. We can copy the contract address, and then let's head back over to Arbitrum. Then we paste in the sender address, which is the contract address on Sepolia, and then we add true, then we hit transact and then we'll be able to receive messages from the contract on Sepolia. Now that that transaction's gone through, let's copy this contract address and then head over to Sepolia by selecting it in our MetaMask, and then making sure that we are still connected via MetaMask, sometimes this takes a few times. Then, on Sepolia we open up our messenger contract again. Let's just check in at the tutorial that we've done everything. So, we've deployed our contract on Sepolia, which is the one that we are sending the messages from, so we're doing this a little bit different from this tutorial. We've deployed the contract, we've enabled the contract to send CCIP messages by calling allow list destination chain selector. We've then deployed on Arbitrum Sepolia and called allow list source chain, and then allow list sender. Now we can send data and pay LINK. First thing we need to do is open MetaMask and connect to this will be Sepolia, and fund my contract with LINK tokens. 

Now, the other thing I'm going to do is click into send message pay LINK and paste in the sender address so I don't have to keep going back and forth, and I'm also then going to copy this Sepolia contract address. I'm then going to go into my MetaMask, if you haven't done so already, the first thing you'll need to do is import the LINK token, and the way to do that is head to the tokens tab, click the plus import button, and then paste in the contract address for the LINK token on Sepolia, which you can find in the directory from before. I'm going to click LINK and then I'm going to hit send and then I'm going to paste in that contract address, and send the contract some LINK. Let's send them 70 LINK tokens. 

Now that we have funded our smart contract with LINK to be able to pay the fees, we have already pasted in the receiver. The destination chain selector, we can get from the supported networks page. And, we need the Arbitrum chain selector. Head back into Remix, paste in the chain selector. The text, we can say something like hey Arbitrum, and then we can send this transaction to send our message cross chain. We can now copy the transaction hash and head to the CCIP explorer. We can then paste in our transaction hash, and you can see here we have an overview of the cross chain message. We have the source transaction hash and then we will have the destination transaction hash. We also have the status, which shows that we are waiting for finality. We now need to wait for the message to be sent cross chain, and then we can check in our Arbitrum smart contract that we have in fact received the message. So, now you can see that this cross chain message was in fact successful, and we could look at the destination transaction hash. So, if we head back to Remix, and now we switch over so that we are on Arbitrum Sepolia. So, we're going to MetaMask, click Arbitrum Sepolia, make sure that we have injected provider dash MetaMask, then we go down to our deployed contract, and then we can click get last received message details dash call. And then you can see here, we now have the message ID, bytes 32, and then the string text, hey Arbitrum, which is super cool! We have now successfully sent a cross chain message from Sepolia to Arbitrum Sepolia, using CCIP. This is massive, well done. 
